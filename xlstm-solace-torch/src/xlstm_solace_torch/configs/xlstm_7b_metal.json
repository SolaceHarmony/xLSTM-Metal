{
  "model_name": "xLSTM-7B-Metal",
  "description": "7B parameter model configuration with Metal acceleration",
  "base_config": "default_metal.json",
  
  "device_settings": {
    "device": "mps",
    "force_mps": true,
    "allow_cpu_fallback": false,
    "validate_metal_only": true
  },
  
  "kernel_configuration": {
    "chunkwise_kernel": "chunkwise--metal_autograd",
    "sequence_kernel": "native_sequence__metal",
    "step_kernel": "metal",
    "force_metal_kernels": true
  },
  
  "model_7b": {
    "embedding_dim": 4096,
    "num_heads": 8,
    "num_blocks": 32,
    "vocab_size": 50304,
    "head_dim": 512,
    "use_bias": false,
    "norm_eps": 1e-6,
    "norm_reduction_force_float32": true,
    "add_out_norm": true,
    "add_post_blocks_norm": true,
    "qk_dim_factor": 0.5,
    "v_dim_factor": 1.0,
    "gate_soft_cap": 15.0,
    "output_logit_soft_cap": 30.0,
    "chunk_size": 64,
    "mode": "inference",
    "ffn_proj_factor": 2.667,
    "ffn_round_up_to_multiple_of": 64,
    "mlstm_round_up_to_multiple_of": 64
  },
  
  "inference_optimizations": {
    "chunk_size": 64,
    "inference_state_dtype": "float32",
    "autocast_kernel_dtype": "bfloat16",
    "return_last_states": true,
    "use_cache": true
  },
  
  "memory_management": {
    "workers": 8,
    "streams": 0,
    "mem_poll_ms": 100,
    "mem_soft_pct": 0.80,
    "mem_hard_pct": 0.90,
    "mem_action": "warn,empty_cache,reduce_chunk_size"
  }
}
